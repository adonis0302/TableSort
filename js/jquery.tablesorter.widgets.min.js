/* TableSorter 2.0 Widgets - updated 12/14/2011 */

(function(c){
c.tablesorter.addWidget({id:"uitheme",format:function(e){var b,a,g,j,h,d=e.config,f=c(e),i=["ui-icon-arrowthick-2-n-s","ui-icon-arrowthick-1-s","ui-icon-arrowthick-1-n"];d.widgetUitheme&&d.widgetUitheme.hasOwnProperty("css")&&(i=d.widgetUitheme.css||i);g=i.join(" ");d.debug&&(b=new Date);f.is(".ui-theme")||(f.addClass("ui-widget ui-widget-content ui-corner-all ui-theme"),c.each(d.headerList,function(){c(this).addClass("ui-widget-header ui-corner-all").append('<span class="ui-icon"/>').hover(function(){c(this).addClass("ui-state-hover")}, function(){c(this).removeClass("ui-state-hover")})}));c.each(d.headerList,function(b){j=c(this);d.headers[b]&&!1===d.headers[b].sorter?j.find("span.ui-icon").removeClass(g+" ui-icon"):(a=j.hasClass(d.cssAsc)?i[1]:j.hasClass(d.cssDesc)?i[2]:j.hasClass(d.cssHeader)?i[0]:"",h=f.hasClass("hasStickyHeaders")?f.find("tr.stickyHeader").find("th").eq(b).add(j):j,h[a===i[0]?"removeClass":"addClass"]("ui-state-active").find("span.ui-icon").removeClass(g).addClass(a))});d.debug&&c.tablesorter.benchmark("Applying uitheme widget", b)}});
c.tablesorter.addWidget({id:"columns",format:function(e){var b,a,g,j,h=e.config,d=h.sortList,f=d.length,i=["primary","secondary","tertiary"];h.widgetColumns&&h.widgetColumns.hasOwnProperty("css")&&(i=h.widgetColumns.css||i);g=i.length-1;j=i.join(" ");h.debug&&(a=new Date);d&&d[0]&&c("tr:visible",e.tBodies[0]).each(function(a){b=c(this).children().removeClass(j);b.eq(d[0][0]).addClass(i[0]);if(1<f)for(a=1;a<f;a++)b.eq(d[a][0]).addClass(i[a]||i[g])});h.debug&&c.tablesorter.benchmark("Applying Columns widget", a)}});
c.tablesorter.addWidget({id:"filter",format:function(e){if(!e.config.filtering){var b,a,g,j,h,d,f=e.config,i=f.headerList.length,k=c(e),e='<tr class="filters">',l;f.debug&&(l=new Date);for(b=0;b<i;b++)e+='<td><input type="text" class="filter" data-col="'+b+'" style="',e+=f.headers[b]&&"filter"in f.headers[b]&&!1===f.headers[b].filter||c(f.headerList[b]).is(".filter-false")?"display:none":"",e+='"></td>';k.find("thead").append(e+="</tr>").find(".filter").bind("keyup",function(){a=k.find(".filter").map(function(){return(c(this).val()|| "").toLowerCase()}).get();""===a.join("")?k.find("tr").show():k.find("tbody").find("tr:not(.expand-child)").each(function(){g=!0;h=c(this).nextUntil("tr:not(.expand-child)");j=h.length&&("undefined"!==typeof f.widgetFilterChildRows?f.widgetFilterChildRows:1)?h.text():"";d=c(this).find("td");for(b=0;b<i;b++)""!==a[b]&&0<=(d.eq(b).text()+j).toLowerCase().indexOf(a[b])?g=g?!0:!1:""!==a[b]&&(g=!1);c(this)[g?"show":"hide"]();if(h.length)h[g?"show":"hide"]()});k.trigger("applyWidgets")});f.filtering=!0; f.debug&&c.tablesorter.benchmark("Applying Filter widget",l)}}});
c.tablesorter.addWidget({id:"stickyHeaders",format:function(e){if(!c(e).hasClass("hasStickyHeaders")){var b=c(e).addClass("hasStickyHeaders"),a=c(window),g=c(e).find("thead"),j=g.find("tr").children(),h=j.eq(0),d=parseInt(j.eq(0).css("border-left-width"),10),f=g.find("tr:not(.filters)").clone().addClass("stickyHeader").css({width:g.outerWidth()+2*d,position:"fixed",left:h.offset().left,marginLeft:-d,top:0,visibility:"hidden",zIndex:10}), i=f.children(),k;b.bind("sortEnd",function(a,b){var d=c(b).find("thead tr"),f=d.filter(".stickyHeader").children();d.filter(":not(.stickyHeader)").children().each(function(a){f.eq(a).attr("class",c(this).attr("class"))})});j.each(function(a){var b=c(this);i.eq(a).width(b.width()).bind("click",function(a){b.trigger(a)}).bind("mousedown",function(){this.onselectstart=function(){return!1};return!1})});g.prepend(f);a.scroll(function(){var c=h.offset(),d=a.scrollTop(),d=d>c.top&&d<c.top+b.find("tbody").height()? "visible":"hidden";f.css({left:c.left-a.scrollLeft(),visibility:d});d!==k&&(a.resize(),k=d)}).resize(function(){f.css({left:h.offset().left-a.scrollLeft(),width:g.outerWidth()+2*d});i.each(function(a){c(this).width(j.eq(a).width())})})}}});
c.tablesorter.addWidget({id:"resizable",format:function(e){if(!e.config.resizable){var b,a=e.config,g=a.headerList,j=g.length,h=function(){a.resizable_position=0;a.resizable_target=null;c(window).trigger("resize")};a.resizable_target=null;a.resizable_position=0; for(b=1;b<j;b++)c(g[b]).append('<div class="resizer" style="cursor:w-resize;position:absolute;height:100%;width:20px;left:-20px;top:0;z-index:1;"></div>').wrapInner('<div style="position:relative;height:100%;width:100%"></div>').find(".resizer").bind("mousedown",function(d){a.resizable_target=c(d.target).closest("th");a.resizable_position=d.pageX}).end().bind("mousemove",function(d){if(!(0===a.resizable_position||null===typeof a.resizable_target)){var c=d.pageX-a.resizable_position,b=a.resizable_target.closest("th").prev(); if(!(a.resizable_target.width()<-c||b&&b.width()<=c))b.width(b.width()+c),a.resizable_position=d.pageX}}).bind("mouseup",function(){h();return!1});c(e).find("thead").bind("mouseup mouseleave",function(){h()});a.resizable=!0}}})
})(jQuery);